---

no_prompts: false
debug: false

# default config => is overwritten by provided config
defaults_zbx_srv:
  version: '7.0'
  timezone:  # if unset - will use your controllers TZ
  domain:
  aliases: []

  # provide settings as environmental variables
  settings:
    # see: https://hub.docker.com/r/zabbix/zabbix-web-nginx-mysql
    frontend: {}

    # see: https://hub.docker.com/r/zabbix/zabbix-server-mysql
    backend: {}

  db:
    root_pwd: "{{ lookup('password', tmp_pwd_file_prefix + '_nc_mdb_root chars=ascii_letters,digits length=' + random_pwd_length) }}"
    app_pwd: "{{ lookup('password', tmp_pwd_file_prefix + '_nc_mdb chars=ascii_letters,digits length=' + random_pwd_length) }}"

  path:
    db: '/var/lib/zabbix/db'

  manage:
    webserver: true

  auto_update:
    enable: true
    timer: 'Sat *-*-* 05:00:00'

  backup:  # todo: implement mariadb backup job
    enable: false
    path: '/var/backups/zabbix'
    retention_days: 14
    timer: '*-*-* 23:00:00'

  # see: https://github.com/ansibleguy/infra_nginx
  nginx:
    ssl:
      mode: 'snakeoil'  # existing/selfsigned/ca/letsencrypt/snakeoil
      cert:
        cn: 'Zabbix-Server Certificate'
      ca:
        cn: 'Zabbix-Server CA'

    config:
      client_max_body_size: '0'
      client_body_timeout: '3600s'
      client_body_buffer_size: '512k'

    headers: {}

  docker_nftables: false
  # reload nftables after docker start to clean the auto-created iptables rules
  # you will have to manage the docker ruleset yourself - example:
  #   forward: {proto: ['tcp', 'udp', 'icmp'], src: '172.18.0.0/16', dest: '172.18.0.0/16'}
  #   output: accept
  #   postrouting: accept & {src: '172.18.0.0/16', dest: '!= 172.18.0.0/16', masquerade: true}
